import { of } from "rxjs";
import { map } from 'rxjs/operators';
import { APP_VALIDATORS } from '../../const/app-validators.const';
import { FormProvider } from '../../util/form-provider';
export function baseAsyncValidator(configModel, validatorName) {
    return (control) => {
        configModel = configModel || {};
        if (configModel.validatorConfig) {
            if (FormProvider.ProcessRule(control, configModel)) {
                return configModel.validatorConfig.pipe(map(resolveConfig(configModel, validatorName, control)));
            }
            return of(null);
        }
        else
            return of(resolveConfig(configModel, validatorName, control)(configModel));
    };
}
function resolveConfig(configModel, validatorName, control) {
    return config => {
        let configClone = { ...configModel, ...config, ...{ expressionProcessed: true } };
        return APP_VALIDATORS[validatorName](configClone)(control);
    };
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYmFzZS5hc3luYy52YWxpZGF0b3IuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi8uLi9wYWNrYWdlcy9yZWFjdGl2ZS1mb3JtLXZhbGlkYXRvcnMvcmVhY3RpdmUtZm9ybS12YWxpZGF0b3JzL2FzeW5jL2Jhc2UuYXN5bmMudmFsaWRhdG9yLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUtBLE9BQU8sRUFBYyxFQUFFLEVBQUUsTUFBTSxNQUFNLENBQUM7QUFDdEMsT0FBTyxFQUFFLEdBQUcsRUFBRSxNQUFNLGdCQUFnQixDQUFDO0FBQ3JDLE9BQU8sRUFBRSxjQUFjLEVBQUUsTUFBTSxrQ0FBa0MsQ0FBQTtBQUNqRSxPQUFPLEVBQUUsWUFBWSxFQUFFLE1BQU0sMEJBQTBCLENBQUM7QUFFeEQsTUFBTSxVQUFVLGtCQUFrQixDQUFDLFdBQWdCLEVBQUUsYUFBcUI7SUFDdEUsT0FBTyxDQUFDLE9BQXdCLEVBQXNDLEVBQUU7UUFDcEUsV0FBVyxHQUFHLFdBQVcsSUFBSSxFQUFFLENBQUM7UUFDaEMsSUFBSSxXQUFXLENBQUMsZUFBZSxFQUFFO1lBQzdCLElBQUksWUFBWSxDQUFDLFdBQVcsQ0FBQyxPQUFPLEVBQUUsV0FBVyxDQUFDLEVBQUU7Z0JBQ2hELE9BQXlCLFdBQVcsQ0FBQyxlQUFnQixDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsYUFBYSxDQUFDLFdBQVcsRUFBRSxhQUFhLEVBQUUsT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUFDO2FBQ3ZIO1lBQ0QsT0FBTyxFQUFFLENBQUMsSUFBSSxDQUFDLENBQUM7U0FDbkI7O1lBRUcsT0FBTyxFQUFFLENBQUMsYUFBYSxDQUFDLFdBQVcsRUFBRSxhQUFhLEVBQUUsT0FBTyxDQUFDLENBQUMsV0FBVyxDQUFDLENBQUMsQ0FBQztJQUNuRixDQUFDLENBQUE7QUFDTCxDQUFDO0FBR0QsU0FBUyxhQUFhLENBQUMsV0FBZ0IsRUFBRSxhQUFxQixFQUFFLE9BQXdCO0lBQ3BGLE9BQU8sTUFBTSxDQUFDLEVBQUU7UUFDWixJQUFJLFdBQVcsR0FBRyxFQUFFLEdBQUcsV0FBVyxFQUFFLEdBQUcsTUFBTSxFQUFDLEdBQUcsRUFBQyxtQkFBbUIsRUFBQyxJQUFJLEVBQUUsRUFBRSxDQUFDO1FBQy9FLE9BQU8sY0FBYyxDQUFDLGFBQWEsQ0FBQyxDQUFDLFdBQVcsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxDQUFBO0lBQzlELENBQUMsQ0FBQTtBQUNMLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge1xyXG4gICAgQWJzdHJhY3RDb250cm9sLFxyXHJcbiAgICBBc3luY1ZhbGlkYXRvckZuXG59IGZyb20gXCJAYW5ndWxhci9mb3Jtc1wiO1xyXG5pbXBvcnQgeyBPYnNlcnZhYmxlLCBvZiB9IGZyb20gXCJyeGpzXCI7XHJcbmltcG9ydCB7IG1hcCB9IGZyb20gJ3J4anMvb3BlcmF0b3JzJztcclxuaW1wb3J0IHsgQVBQX1ZBTElEQVRPUlMgfSBmcm9tICcuLi8uLi9jb25zdC9hcHAtdmFsaWRhdG9ycy5jb25zdCdcclxuaW1wb3J0IHsgRm9ybVByb3ZpZGVyIH0gZnJvbSAnLi4vLi4vdXRpbC9mb3JtLXByb3ZpZGVyJztcclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBiYXNlQXN5bmNWYWxpZGF0b3IoY29uZmlnTW9kZWw6IGFueSwgdmFsaWRhdG9yTmFtZTogc3RyaW5nKTogQXN5bmNWYWxpZGF0b3JGbiB7XHJcbiAgICByZXR1cm4gKGNvbnRyb2w6IEFic3RyYWN0Q29udHJvbCk6IE9ic2VydmFibGU8eyBba2V5OiBzdHJpbmddOiBhbnkgfT4gPT4ge1xyXG4gICAgICAgIGNvbmZpZ01vZGVsID0gY29uZmlnTW9kZWwgfHwge307XHJcbiAgICAgICAgaWYgKGNvbmZpZ01vZGVsLnZhbGlkYXRvckNvbmZpZykge1xyXG4gICAgICAgICAgICBpZiAoRm9ybVByb3ZpZGVyLlByb2Nlc3NSdWxlKGNvbnRyb2wsIGNvbmZpZ01vZGVsKSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuICg8T2JzZXJ2YWJsZTxhbnk+PmNvbmZpZ01vZGVsLnZhbGlkYXRvckNvbmZpZykucGlwZShtYXAocmVzb2x2ZUNvbmZpZyhjb25maWdNb2RlbCwgdmFsaWRhdG9yTmFtZSwgY29udHJvbCkpKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gb2YobnVsbCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2VcclxuICAgICAgICAgICAgcmV0dXJuIG9mKHJlc29sdmVDb25maWcoY29uZmlnTW9kZWwsIHZhbGlkYXRvck5hbWUsIGNvbnRyb2wpKGNvbmZpZ01vZGVsKSk7XHJcbiAgICB9XHJcbn1cclxuXHJcblxyXG5mdW5jdGlvbiByZXNvbHZlQ29uZmlnKGNvbmZpZ01vZGVsOiBhbnksIHZhbGlkYXRvck5hbWU6IHN0cmluZywgY29udHJvbDogQWJzdHJhY3RDb250cm9sKSB7XHJcbiAgICByZXR1cm4gY29uZmlnID0+IHtcclxuICAgICAgICBsZXQgY29uZmlnQ2xvbmUgPSB7IC4uLmNvbmZpZ01vZGVsLCAuLi5jb25maWcsLi4ue2V4cHJlc3Npb25Qcm9jZXNzZWQ6dHJ1ZSB9IH07XHJcbiAgICAgICAgcmV0dXJuIEFQUF9WQUxJREFUT1JTW3ZhbGlkYXRvck5hbWVdKGNvbmZpZ0Nsb25lKShjb250cm9sKVxyXG4gICAgfVxyXG59Il19